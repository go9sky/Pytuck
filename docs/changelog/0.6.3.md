# Changelog - v0.6.3

> 发布日期 / Release Date: 2026-02-03

---

## 中文

### 新增

- **CSV 后端 ZIP 密码保护**
  - 新增 `CsvBackendOptions.password` 选项，支持创建加密 ZIP 文件
  - 使用 ZipCrypto 加密算法（纯 Python 实现，无外部依赖）
  - 生成的加密 ZIP 兼容 WinRAR、7-Zip 等通用解压工具
  - 示例：
    ```python
    from pytuck.common.options import CsvBackendOptions

    # 创建加密 CSV 存储
    opts = CsvBackendOptions(password="my_password")
    db = Storage(file_path="data.zip", engine="csv", backend_options=opts)
    ```
  - **安全性说明**：ZipCrypto 加密强度较弱，仅适合防止随意查看。如需高安全性，建议使用 Binary 后端的加密功能（支持 ChaCha20）

- **查询条件列名映射**
  - 支持在查询条件中使用模型字段名，自动转换为数据库列名
  - 使用 `Column(type, name='db_column')` 定义列时，查询条件自动映射

### 修复

- **数据库列名映射问题**
  - 修复查询条件中列名映射和匹配问题

- **无主键模型 get 方法**
  - 修复 `session.get()` 对无主键模型的处理
  - 改进数据映射逻辑

### 测试

- 添加 CSV 后端 ZIP 加密功能测试（12 个测试用例）
- 添加配置错误、多线程安全、高级查询功能等测试用例
- 添加引擎元数据规范和错误恢复测试

---

## English

### Added

- **CSV Backend ZIP Password Protection**
  - Added `CsvBackendOptions.password` option to create encrypted ZIP files
  - Uses ZipCrypto encryption (pure Python, no external dependencies)
  - Generated encrypted ZIP is compatible with WinRAR, 7-Zip and other tools
  - Example:
    ```python
    from pytuck.common.options import CsvBackendOptions

    # Create encrypted CSV storage
    opts = CsvBackendOptions(password="my_password")
    db = Storage(file_path="data.zip", engine="csv", backend_options=opts)
    ```
  - **Security Note**: ZipCrypto is a weak encryption, suitable for casual protection only. For high security, use Binary backend encryption (ChaCha20)

- **Query Condition Column Name Mapping**
  - Support using model field names in query conditions with automatic conversion to database column names
  - When using `Column(type, name='db_column')`, query conditions are automatically mapped

### Fixed

- **Database Column Name Mapping Issue**
  - Fixed column name mapping and matching in query conditions

- **Primary Key-less Model get() Method**
  - Fixed `session.get()` handling for primary key-less models
  - Improved data mapping logic

### Tests

- Added CSV backend ZIP encryption tests (12 test cases)
- Added configuration error, multi-thread safety, and advanced query tests
- Added engine metadata specification and error recovery tests
